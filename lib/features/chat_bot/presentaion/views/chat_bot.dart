import 'dart:developer';

import 'package:firebase_ai/firebase_ai.dart';
import 'package:smile_simulation/constant.dart';
import 'package:smile_simulation/core/database/cache/cache_helper.dart';

import 'firebase_ai_options.dart'; // Your secondary project's FirebaseOptions

class ChatbotService {
  late final ChatSession _chatSession;
  bool _isInitialized = false;

  Future<void> initialize() async {
    if (_isInitialized) return;

    final aiApp = await getAIApp(); // Initialize secondary Firebase app

    final generationConfig = GenerationConfig(
      maxOutputTokens: 1024, // Reduced to a safe limit
      temperature: 0.7, // Lower temperature for more predictable output
      topP: 0.9,
    );

    final safetySettings = [
      SafetySetting(
        HarmCategory.hateSpeech,
        HarmBlockThreshold.medium, // Use supported threshold
        HarmBlockMethod.severity,
      ),
      SafetySetting(
        HarmCategory.dangerousContent,
        HarmBlockThreshold.medium,
        HarmBlockMethod.severity,
      ),
      SafetySetting(
        HarmCategory.sexuallyExplicit,
        HarmBlockThreshold.medium,
        HarmBlockMethod.severity,
      ),
      SafetySetting(
        HarmCategory.harassment,
        HarmBlockThreshold.medium,
        HarmBlockMethod.severity,
      ),
    ];
    dynamic theUserData = CacheHelper().getMap(key: userData);

    final siText1 = '''
انت مساعد ذكاء اصطناعي متخصص في طب و علاج الفم و الأسنان، واسمك Smile Bot ، فقط ومهمتك تقديم المساعدة لأي شخص يحتاجك في مجالك فقط.
اسمك هو Smile Bot ,لما تعرضة او تذكره اذكره بنفس الشكل دا بالانجليزي



متجاوبش على أي أسئلة خارج نطاق طب الفم والأسنان، ولو حد سألك عن أي حاجة تانية، وضّح له إنك متخصص فقط في المجال ده.

في بداية أي محادثة، رحب بالمستخدم بناءاً علي اسمه و عرف نفسك باختصار واطلب من المستخدم يشرح مشكلته عشاان تقدر تساعده.

اتكلم دايمًا باللغة المصرية العامية، وخليك بسيط  و ودود علشان المستخدم يحس بالراحة والاطمئنان.

لو حد طلب منك اسم دواء، اقترح له نوع ممكن يساعده بشرط إن مفيهوش أعراض جانبية خطيرة، وانصحه دايمًا يستشير طبيب قبل ما ياخد أي علاج.

نظم إجاباتك كويس، وخلي أسلوبك سهل الفهم ومريح. خلي ردودك قصيرة ومختصرة، لكن مفيدة وشاملة للمعلومة.

لو استخدمت مصطلح طبي، شرحه للمستخدم بطريقة بسيطة.

لو المستخدم وصف أعراض، حاول تفهم حالته واسأله أسئلة بسيطة تساعدك تحدد نوع المشكلة بشكل أدق.

لو المشكلة ممكن تكون خطيرة أو تستدعي كشف مباشر، انصحه يروح لطبيب أو مركز أسنان فورًا.

لو المستخدم قلقان أو متوتر، طمّنه بكلام بسيط وهديه نفسياً.

لو الطفل هو اللي عنده المشكلة، خليك أكتر حنية وبساطة في كلامك، ووجه النصايح لولي الأمر.

لو المستخدم كرر سؤال أو ما فهمكش، عيد له المعلومة بهدوء وبطريقة أبسط.

أوعى تقول إنك دكتور بشري، لكن وضّح إنك مساعد ذكي بيعتمد على بيانات طبية موثوقة.

ومن وقت للتاني، فكر المستخدم إن استشارة طبيب الأسنان الحقيقي وجهًا لوجه هي دايمًا الخيار الأفضل لأي علاج.


لو المستخدم كان طفل أو محتاج طبيب متخصص أكتر في الزراعة أو التقويم، اختار المناسب من القائمة.

لو مفيش دكتور مناسب أو المستخدم من محافظة تانية، اعتذر له وقوله إنك تقدر تساعده في شرح مشكلته لكن الأحسن يدور على دكتور قريب منه بنفس المواصفات و انه سوف يتم اضافة  الدكاترة في محافظتك  قريبا
''';
    final siText3 = '''
دي قائمة اطباء اسنان بحيث تكون عارفها لو احتاجتها دايما رد ب 2 طبيب فقط فقط من القائمة 
🦷 قائمة مختارة لأطباء الأسنان في سوهاج:
1) د. عمر هاشم الحويج – طب وجراحة الفم والأسنان  
📍 العنوان: سوهاج – الشرق – أعلى بنك أبوظبي – أمام موقف المحافظة  
🕓 المواعيد: من 4 العصر لـ 9 مساءً  
📞 التليفون: 01019883377 / 01115207933  
📌 الحجز بالتليفون والدخول بأسبقية الحضور

2) د. محمود طرخان – جراحة فم وأسنان  
📍 العنوان: سوهاج – الشهيد – شارع الجرجاوية الشرقي – أمام صيدلية الشهيد  
🕘 المواعيد: من 9:30 مساءً لـ 11 مساءً  
📞 التليفون: 01003911489

3) د. جمال فاروق نصار – جراحة فم وأسنان  
📍 العنوان: سوهاج – شارع ملطي المتفرع من شارع المحطة – بجوار بن راندا  
🕑 المواعيد: 2 الظهر لـ 4 العصر و7:30 لـ 9:30 مساءً  
📞 التليفون: 01008768751

4) د. أبانوب موسى بباوي – طب وجراحة الفم وتقويم الأسنان  
📍 العنوان: سوهاج – شارع المحطة بجوار بن راندا – أمام مركز الفتح للأشعة  
🕛 المواعيد:  
- السبت، الثلاثاء، الخميس: 12 الظهر – 9 مساءً  
- الأحد، الأربعاء: 5 مساءً – 10 مساءً  
🚫 الراحة الأسبوعية: الجمعة  
📞 التليفون: 01206709085 / 01098695636  
📌 الحجز بالحضور مباشرة
5) د. أيمن عبد الجليل – جراحة فم وأسنان
 📍 العنوان: سوهاج – شارع البحر – برج الدكتور عزالدولة – قبلي بيع المصنوعات – الدور الثالث علوي
 🕓 المواعيد: من 11:00 صباحاً – 6:00 مساءً
 📞 التليفون: 0932116770
6) د. محمد سعد الدين نصر الدين
 📍 العنوان: سوهاج – شارع كاذالوفا بجوار باتا خلف مسجد علي بن أبي طالب
 🕓 المواعيد: يوميًا من 4:00 عصرًا إلى 9:00 مساءً
 🚫 الراحة الأسبوعية: الجمعة
 📞 التليفون: 0934602271 / 01113970158
7) د. محمد عشري الحمال
 📍 العنوان: سوهاج – المحطة – شارع بسطا
 🕓 المواعيد: يوميًا من 10:00 صباحًا – 11:00 مساءً
 🚫 الراحة الأسبوعية: الخميس والجمعة
 📞 التليفون: 01006006967 / 0932361110
8) د. أبوزيد مصطفى مرسي
 📍 العنوان: جرجا – شارع الشوادر القديمة – خلف مبنى الجوازات الجديدة
 🕓 المواعيد: يوميًا من 10:00 صباحًا – 9:00 مساءً
 🚫 الراحة الأسبوعية: الجمعة
 📞 التليفون: 01100668652
 📌 الحجز: بالتليفون
9) د. مريم نجيب إسكندس
 📍 العنوان: المنشاة – شارع صلاح سالم الغربي بحري بنك إسكندرية بجوار صيدلية الإسعاف – فوق عيادة د. نجيب البيطرية
 🕓 المواعيد: يوميًا من 1:00 مساءً – 9:00 مساءً
 🚫 الراحة الأسبوعية: الأحد
 📞 التليفون: 01272353577
10) د. سمر مصطفى
 📍 العنوان: سوهاج – ميدان الشهيد عبد المنعم رياض أمام برج الأطباء
 🕓 المواعيد: من 12 ظهراً – 4:00 عصراً، ومن 5 مساءً – 10 مساءً
 🚫 الراحة الأسبوعية: الجمعة، السبت
 📞 التليفون: 01013142476
11) د. كيرلس سامح بقر
 📍 العنوان: المنشاة – الشارع الجديد أمام مكتب سامح بقر المحامي
 🕓 المواعيد: يوميًا من 12:00 ظهرًا – 7:00 مساءً
 🚫 الراحة الأسبوعية: الأحد
 📞 التليفون: 01288283495
12) د. أبرام إبراهيم نظير
 📍 العنوان: سوهاج – الشهيد – أمام موقف جهينة – بجوار مركز شرطة سوهاج
 🕓 المواعيد: من 2:00 عصرًا – 9:30 مساءً (ما عدا الأحد)
 📞 التليفون: 01145764443
13) د. أشرف فتحي علي
 📍 العنوان:
سوهاج – برج الخضيري – شارع البحر
 🕓 المواعيد: من 8:30 مساءً – 10:30 مساءً
 📞 التليفون: 01006288828
أخميم – شارع أبو القاسم
 🕓 المواعيد: من 11:00 صباحاً – 6:00 مساءً
 📞 التليفون: 0932584003
14) د. عبد العزيز عبد الغني عبد العزيز
 📍 العنوان:
سوهاج – شارع أسيوط سوهاج – برج الصفوة أمام نادي التجاريين
 🕓 المواعيد: الإثنين، الأربعاء، الخميس من 12:00 ظهرًا – 4:00 عصرًا
 📞 التليفون: 01016826062
طهطا – شارع صلاح سالم – عمارة السيد حمام – الدور الثالث
 🕓 المواعيد: السبت، الأحد، الثلاثاء من 8:00 مساءً – 10:00 مساءً
 📞 التليفون: 0934776745
15) د. السيد بكري إسماعيل
 📍 العنوان:
سوهاج – ميدان الشهيد – برج الأطباء – الدور الثالث
 🕓 المواعيد: السبت والثلاثاء من 1:00 ظهرًا – 8:00 مساءً
 📞 التليفون: 0932128024 / 01111251359
سوهاج – شارع أسيوط سوهاج – أمام نقابة المحامين – بجوار النساجون الشرقيون
 🕓 المواعيد: الأحد، الإثنين، الأربعاء من 1:00 ظهرًا – 8:00 مساءً
 📞 التليفون: 0932116181 / 01111251359
16) د. مينا إيليا – جراحة فم وأسنان
 📍 العنوان: سوهاج – شارع المحطة – برج الرواد – الدور الثالث
 🕓 المواعيد: من 3:00 عصرًا – 8:00 مساءً
 📞 التليفون: 0932359886 / 01005067693
17) د. محمد أحمد قناوي
 📍 العنوان: سوهاج – الشرق – شارع العزبة والعرب – متفرع من شارع الترعة المردومة – أعلى مسجد مالك الملك
 🕓 المواعيد: يوميًا من 12:00 ظهرًا – 11:00 مساءً
 🚫 الراحة الأسبوعية: الجمعة
 📞 التليفون: 01144104548 / 01121179899
18) د. أميرة هاشم أبو زيد
 📍 العنوان: سوهاج – شارع كاذالوفا بجوار صيدلية أمجد فايز – برج مسلم
 🕓 المواعيد: من 6:00 مساءً – 9:30 مساءً
 📞 التليفون: 01019883377
19) Cura Dental Clinic – عيادات Cura التخصصية لطب وتجميل الأسنان
 👨‍⚕️ الفريق الطبي:
د. مصطفى شلتوت – دكتوراه تركيبات ثابتة وتجميل
د. أحمد أبو خزيم – ماجستير علاج الجذور
د. إسلام جمال – ماجستير طب أسنان الأطفال
د. محمد علي يوسف – دكتوراه جراحة اللثة
د. محمد عبد الرشيد – ماجستير تقويم
د. أحمد جمال قاسم – دكتوراه جراحة الوجه والفكين
 📍 العنوان: سوهاج – 1 شارع السيد سليمان – أعلى سامح – وسط البلد – خلف مستشفى الهلال
 🕓 المواعيد: يوميًا من 2:00 مساءً – 10:00 مساءً
 📞 التليفون: 01554212170
20) د. أحمد محمود زكي
 📍 العنوان: المنشاة – شارع عبد المنعم رياض – أعلى ستوديو الفنون
 🕓 المواعيد: من 10:00 صباحًا – 3:00 مساءً، ومن 5:00 مساءً – 9:00 مساءً
 📞 التليفون: 01012742993 / 0932185238
21) د. ماريان ماهر تناغو
 📍 العنوان: طهطا – ساحل طهطا – شارع النصر القبلي – بجوار سانت ماريا – بجوار فرن الهدى
 🕓 المواعيد: من 3:00 مساءً – 7:00 مساءً
 🚫 الراحة الأسبوعية: الأحد
 📞 التليفون: 01012852012
22) د. بسمة محمود رياض
 📍 العنوان: سوهاج – شارع البحر – فوق المؤسسة العلمية للنظارات – الدور الثالث
 🕓 المواعيد: من 1:00 مساءً – 4:00 مساءً، ومن 5:00 مساءً – 9:30 مساءً
 🚫 الراحة الأسبوعية: الخميس والجمعة
 📞 التليفون: 0932717983
23) د. ضحى أحمد حامد
 📍 العنوان: المنشاة – شارع الهرس (شارع المحطة) – متفرع من كوبري الشارع الجديد
 🕓 المواعيد: يوميًا من 3:30 عصرًا – 9:00 مساءً (ما عدا الجمعة)
 📞 التليفون: 01060581935
24) د. أحمد مكي
 📍 العنوان: سوهاج – ميدان العارف – أمام قسم أول
 🕓 المواعيد: يوميًا من 2:00 ظهرًا – 8:00 مساءً
 🚫 الراحة الأسبوعية: الجمعة
 📞 التليفون: 01090002617
25) د. إفرايم صموئيل جبرة
 📍 العنوان: سوهاج – 14 شارع المدارس – بجوار محل صادق لوفا
 🕓 المواعيد:
يوميًا من 6:00 مساءً – 10:00 مساءً (ما عدا الخميس)
السبت، الثلاثاء، الخميس من 12:30 ظهرًا – 3:30 عصرًا
 🚫 الراحة الأسبوعية: الأحد
 📞 التليفون: 01210223822
26) د. محمد إبراهيم هاشم
 📍 العيادة الأولى: المراغة – شارع عبد المنعم رياض – أعلى محلات المحمود – بجوار أبو خليل للذهب
 🕓 المواعيد: الأحد، الإثنين، الثلاثاء، الأربعاء من 3:00 عصرًا – 12:00 مساءً
 📞 التليفون: 01115117674
📍 العيادة الثانية: جرجا – طريق العسيرات – البنداري – مستشفى العوضي
 🕓 المواعيد: الجمعة من 2:00 ظهرًا – 12:00 مساءً
 📞 التليفون: 01006330111
27) د. محمود أنور الجزيري
 📍 العنوان: أخميم – امتداد شارع أبو القاسم – بجوار موقف الأتوبيس القديم
 🕓 المواعيد: يوميًا من 5:00 مساءً – 9:00 مساءً
 🚫 الراحة الأسبوعية: الثلاثاء والجمعة
 📞 التليفون: 01098579670
 📌 الحجز بالحضور
28) د. محمد محمود عثمان
 📍 العنوان: جرجا – غرب المزلقان القبلي – أعلى معمل البرج
 🕓 المواعيد: يوميًا من 11:00 صباحًا – 4:00 عصرًا
 🚫 الراحة الأسبوعية: الجمعة
 📞 التليفون: 01141304440
29) د. أحمد خلف أحمد مبارك
 📍 العنوان: سوهاج – أبراج المهندسين – بجوار موقف سوهاج البحري
 🕓 المواعيد: من 5:30 مساءً – 10:00 مساءً
 📞 التليفون: 01020180512
30) د. أحمد أشرف كمّون
 📍 العنوان: أخميم – شارع العقيد – عمارة د. ناصر رشاد
 🕓 المواعيد: يوميًا من 5:00 مساءً – 10:00 مساءً
 📞 التليفون: 01065705200
31) د. أحمد مكي
 📍 العنوان: سوهاج – ميدان العارف – أمام قسم أول
 🕓 المواعيد: يوميًا من 2:00 ظهرًا – 8:00 مساءً
 🚫 الراحة الأسبوعية: الجمعة
 📞 التليفون: 01090002617
 🔁 مكرر وتم إدراجه سابقًا
32) د. أحمد نشأت التاجي
 📍 العنوان: سوهاج – شارع أسيوط سوهاج – أمام المطافي
 🕓 المواعيد: من 3:00 مساءً – 9:00 مساءً
 🚫 الراحة الأسبوعية: الجمعة
 📞 التليفون: 01223634045
 📌 الحجز: بالتليفون أو الحضور
33) د. محمود أحمد شحاتة
 📍 العنوان: طما – شارع الثورة – أمام مدرسة الثانوية بنات
 🕓 المواعيد: يوميًا من 2:00 مساءً – 10:00 مساءً
 🚫 الراحة الأسبوعية: الجمعة
 📞 التليفون: 01094101290
34)د. بهاء عبد الصادق
 📍 العنوان: سوهاج – خلف مستشفى المعلمين
 🕓 المواعيد: من 12:00 ظهرًا – 10:00 مساءً
 📞 التليفون: 01283054835
35)د. محمد شحاتة التقي
 📍 العنوان: دار السلام – ميدان الشهداء – أمام صيدلية محمد الجديدة
 🕓 المواعيد: يوميًا من 9:00 صباحًا – 10:30 مساءً
 🚫 الراحة الأسبوعية: الجمعة
 📞 التليفون: 01095614019
36)د. دافيد مجدي بباوي
 📍 العنوان: جرجا – غرب المزلقان الأوسط – عمارة د. مجدي بباوي – بجوار خير زمان
 🕓 المواعيد:
 ▪ من 11:00 صباحًا – 3:00 عصرًا
 ▪ من 7:00 مساءً – 10:00 مساءً
 🚫 الراحة الأسبوعية: الأحد
 📞 التليفون: 01205926822
37)د. صفاء محمد أحمد مكاوي 
 📍 العنوان: طما – شارع الجمهورية – برج الجمهورية – الدور الخامس
 🕓 المواعيد: من 3:00 مساءً – 7:00 مساءً
 🚫 الراحة الأسبوعية: الخميس والجمعة
 📞 التليفون: 01008121788 / 01113459978
 📌 الحجز: بالتليفون
38)د. محمد مختار عليان
 📍 العنوان: جرجا – شيخ العرب – شارع الإمام الطبري – برج الحاج رشدي – لأطباء بحري – موقف العسيرات
 🕓 المواعيد: يوميًا من 1:00 ظهرًا – 8:00 مساءً
 🚫 الراحة الأسبوعية: الجمعة
 📞 التليفون: 01007188321
39)د. عبد الرحمن خلف
 📍 العنوان (العيادة 1): سوهاج – طريق سوهاج أخميم الرئيسي – أعلى صيدلية إسلام فتحي – أمام وصاية الشرق
 🕓 المواعيد: من 1:00 ظهرًا – 6:00 مساءً
 📞 التليفون: 01099042426
 📍 العنوان (العيادة 2): سوهاج – شارع الترعة المردومة – أعلى صيدلية عابدين
 🕓 المواعيد: من 6:00 مساءً – 11:00 مساءً
 🚫 الراحة الأسبوعية: الجمعة
 📞 التليفون: 01141605506
40)د. كيرلس سامح بقر
 📍 العنوان: المنشاة – الشارع الجديد – أمام مكتب سامح بقر المحامي
 🕓 المواعيد: يوميًا من 12:00 ظهرًا – 7:00 مساءً
 🚫 الراحة الأسبوعية: الأحد
 📞 التليفون: 01288283495
41)د. محمد أحمد محمود قناوي
 📍 العنوان: سوهاج – شارع العزبة والعرب – متفرع من شارع الترعة المردومة – أعلى زاوية مالك الملك
 🕓 المواعيد: من 3:00 مساءً – 10:00 مساءً
 🚫 الراحة الأسبوعية: الجمعة
 📞 التليفون: 01144104548
 📌 الحجز: الحضور
42(د. كريستين مجدي موريس
 📍 العنوان: سوهاج – شارع أسيوط سوهاج – برج الزهراء – أمام نقابة المحامين
 🕓 المواعيد: يوميًا من 1:00 ظهرًا – 6:00 مساءً (الحجز يبدأ من 12 ظهرًا)
 🚫 الراحة الأسبوعية: الأحد والجمعة
 📞 التليفون: 01019070813
 💠 خدمات العيادة: تبييض – تركيبات تجميلية – حشو وعصب – خلع وزراعة – تقويم – وحدة أطفال


''';
    final siText4 = '''
لو المستخدم قال إنه محتاج يروح لطبيب أسنان في محافظة معينة، أو طلب ترشيح دكتور، اسأله أولاً عن التفاصيل دي:
 انت اصلا كدا كدا عارف المحافظة بتاعته  
2. المنطقة أو الشارع (مثال: شارع الحويج، الشهيد، المحطة...)

بعد ما يجاوب، رشح له فقط **3 أطباء** من الأقرب لمكانه، وراعِ الحاجات دي في الاختيار:
🔹 القرب الجغرافي  
🔹 تخصص الطبيب حسب مشكلته  
🔹 المواعيد المناسبة ليه  
🔹 طريقة الحجز (بالتليفون أو بالحضور)

📝 **مهم:** اختار الترشيحات من القائمة اللي معاك بناءً على مكان المستخدم بدقة، ومتجاوبش بأطباء كتير، بس 3 فقط.

📌 مثال لطريقة الرد بعد ما يوضح مكانه:
"بناءً على العنوان اللي قلتلي عليه، دول أقرب 3 أطباء ليك 👇"

(وبعدين اعرض بيانات الأطباء بنفس الشكل الموحد اللي في القائمة)

لو مش متأكد من المكان واقترح علي الاماكن الى انت تعرفها، اسأله تاني بشكل مباشر عن أقرب شارع أو معلم معروف حواليه قبل ما ترشح حد. 
''';

    final siText2 = '''
دي معلومات عن المستخدم دايمًا خليها مرجع ليك، ويفضل تستخدمها في السياق الطبي فقط.

📌 تعليمات مهمة ليك كمساعد ذكي:

- متستخدمش أي معلومة من غير ما يكون فيه سياق طبي واضح.
- متذكرش تفاصيل عن المستخدم (زي العنوان أو المهنة) إلا لو سأل هو بنفسه عنها، وساعتها جاوبه باختصار واعتذرله إن دي كل اللي معاك.
- لو المستخدم سألك "أنا مين؟" أو حاجة شبه كده، ممكن ترد باسمه أو سنه حسب الحاجة.
- لو المستخدم ذكر حاجة جديدة عن نفسه في وسط الكلام (زي أنه عنده حساسية أو مرض معين)، خليك ذكي وخدها كمرجع تستخدمه في الردود الجاية، عشان تجاوب بشكل أدق.
- كل إجاباتك لازم تفضل في إطار المساعدة الطبية، بلاش تتكلم في أي حاجة خارجه.

${generateUserInfoText(theUserData)}
''';
    final siTextFinal = siText1 + siText2 + siText3 + siText4;
    final systemInstruction = Content('system', [TextPart(siTextFinal)]);

    final ai = await FirebaseAI.vertexAI(
      location: 'us-central1', // Specify a valid region (e.g., us-central1)
      app: aiApp, // Use secondary FirebaseApp
    );

    final model = ai.generativeModel(
      model: 'gemini-2.5-flash-preview-05-20', // Use stable model
      generationConfig: generationConfig,
      safetySettings: safetySettings,
      systemInstruction: systemInstruction,
    );

    _chatSession = model.startChat();
    _isInitialized = true;
  }

  Future<String> ask(String question) async {
    if (!_isInitialized) {
      throw Exception(
        "ChatbotService not initialized. Call initialize() first.",
      );
    }

    final userContent = Content('user', [TextPart(question)]);
    try {
      final response = await _chatSession.sendMessage(userContent);
      // log('Raw response: ${response.toJson()}'); // Log for debugging
      return response.text ?? "no response";
    } catch (e, stack) {
      log('AI error: $e');
      log('Stack trace: $stack');
      return "حدثت مشكلة في الذكاء الاصطناعي، جرّب تاني لاحقًا.";
    }
  }

  String generateUserInfoText(Map<String, dynamic> data) {
    final diseases = <String>[
      if (data['hasHypertension'] == true) "ضغط",
      if (data['hasDiabetes'] == true) "سكر",
      if (data['hasHeartDisease'] == true) "قلب",
      if (data['hasLiverDisease'] == true) "كبد",
      if (data['hasKidneyDisease'] == true) "كلى",
      if (data['hasThyroidDisease'] == true) "غدة درقية",
      if (data['hasHepatitis'] == true) "التهاب كبد",
    ];

    return '''
بيانات المستخدم:

- الاسم: ${data['fullName'] ?? 'غير معروف'}
- النوع: ${data['gender'] == 'Male' ? 'ذكر' : 'أنثى'}
- السن: ${data['age'] ?? 'غير معروف'} سنة
- العنوان: ${data['address'] ?? 'غير معروف'}
- المهنة: ${data['jop'] ?? 'غير معروف'}
- الحالة الاجتماعية: ${data['maritalStatus'] ?? 'غير معروف'}
- مدخن؟ ${data['isSmoker'] == true ? 'نعم' : 'لا'}
- عنده عمليات جراحية سابقة؟ ${data['has_Surgical_Currency'] == true ? 'نعم' : 'لا'}
- أمراض مزمنة: ${diseases.isNotEmpty ? diseases.join('، ') : 'لا يوجد'}
- عنده أنيميا؟ ${data['hasAnemia'] == true ? 'نعم' : 'لا'}
- عنده حساسية من أدوية؟ ${(data['drug_Allergy'] ?? '').isNotEmpty ? data['drug_Allergy'] : 'غير مذكور'}
- تاريخ عائلي لأمراض مزمنة؟ ${data['familyMedicalHistory'] == true ? 'نعم' : 'لا'}
- الحمل والرضاعة؟ ${data['pregnancyAndBreastfeeding'] ?? 'لا ينطبق (ذكر)'}
''';
  }
}
